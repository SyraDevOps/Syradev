# Syra Interpreter

Um interpretador simples para a linguagem **Syra**, feito em Python, com suporte a vari√°veis, comandos customizados, blocos `match`, fun√ß√µes, lambdas, decoradores, par√¢metros avan√ßados e modo interativo (REPL).

---

## üöÄ Como usar

### Executar um arquivo `.syra`
```sh
python syra_interpreter.py arquivo.syra
```

### Modo Interativo (REPL)
```sh
python syra_interpreter.py
```
Digite comandos Syra diretamente no terminal. As vari√°veis s√£o mantidas durante a sess√£o.

---

## üìö Funcionalidades e Sintaxe

### 1. **Indenta√ß√£o Obrigat√≥ria**

A linguagem **Syra** exige **indenta√ß√£o clara e consistente** para blocos de c√≥digo, como fun√ß√µes, classes, `match`, `each`, etc. Isso significa que todas as linhas que fazem parte de um bloco devem estar **mais indentadas** do que a linha que define o in√≠cio do bloco.

#### **Regras de Indenta√ß√£o**
- **Blocos de c√≥digo** devem ser indentados com **espa√ßos** ou **tabula√ß√£o**, mas a indenta√ß√£o deve ser consistente em todo o arquivo.
- Linhas n√£o indentadas ou com indenta√ß√£o menor do que a linha inicial do bloco **finalizam o bloco**.
- Linhas vazias dentro de um bloco s√£o permitidas, mas devem manter a indenta√ß√£o correta.

#### **Exemplo de Indenta√ß√£o Correta**
```syra
saudacao(nome, saudacao_txt="Ol√°") is -> str:
    "Retorna uma sauda√ß√£o personalizada."
    return saudacao_txt + ", " + nome

info(nome, *detalhes, idade=99, cidade="N/A") is:
    return "Nome: " + nome + " | Idade: " + str(idade) + " | Cidade: " + cidade + " | Detalhes: " + str(detalhes)

triplica(func) is:
    return (a, b) is func(a, b) * 3

@triplica
soma_tripla(a, b) is -> int:
    return a + b
```

#### **Exemplo de Indenta√ß√£o Incorreta**
```syra
saudacao(nome, saudacao_txt="Ol√°") is -> str:
"Retorna uma sauda√ß√£o personalizada."  // N√£o est√° indentado
return saudacao_txt + ", " + nome      // N√£o est√° indentado
```

#### **Blocos Suportados**
- **Fun√ß√µes:** O corpo da fun√ß√£o deve ser indentado.
- **Classes:** O corpo da classe e seus m√©todos devem ser indentados.
- **Blocos `match`:** Cada `case` deve ser indentado em rela√ß√£o ao cabe√ßalho `match`.
- **Blocos `each`:** O corpo do loop deve ser indentado.

#### **Exemplo com `match`**
```syra
resultado = match $idade:
    case 0          => "Rec√©m-nascido"
    case 1..12      => "Crian√ßa"
    case 13..17     => "Adolescente"
    case 18..59     => "Adulto"
    case 60..200    => "Idoso"
    case _          => print("Idade inv√°lida")
shw($resultado)
```

#### **Exemplo com `each`**
```syra
each $item in [1, 2, 3, 4]:
    shw($item)
```

---

### 2. **Vari√°veis**
- Sempre come√ßam com `$`.
- Atribui√ß√£o:  
  ```syra
  $nome = "Syra"
  $idade = 25
  ```
- S√≥ √© poss√≠vel acessar vari√°veis usando o `$`:
  ```syra
  shw($nome)
  ```

### 3. **Fun√ß√µes Syra**
- Defini√ß√£o:
  ```syra
  soma(a, b) is a + b
  ```
  ou bloco:
  ```syra
  saudacao(nome, saudacao_txt="Ol√°") is -> str:
      "Retorna uma sauda√ß√£o personalizada."
      return saudacao_txt + ", " + nome
  ```
- Suporta:
  - Par√¢metros padr√£o: `x=10`
  - Par√¢metros vari√°dicos: `*args`
  - Par√¢metros keyword-only: `*, y=2`
  - Anota√ß√£o de tipo de retorno: `is -> int:`
  - Docstring (primeira linha entre aspas no corpo)
  - Corpo de bloco com `return ...`
- Chamada:
  ```syra
  shw(soma(2, 3))
  ```

### 4. **Fun√ß√µes Lambda Syra**
- Sintaxe:
  ```syra
  $minha_lambda = (x, y=5) is x + y
  shw($minha_lambda(10))      // 15
  shw($minha_lambda(10, 20))  // 30
  ```
- Lambdas podem ser passadas como argumentos para outras fun√ß√µes.

### 5. **Decoradores Syra**
- Defina decoradores como fun√ß√µes que recebem outra fun√ß√£o e retornam uma nova fun√ß√£o Syra.
- Exemplo:
  ```syra
  triplica(func) is:
      return (a, b) is func(a, b) * 3

  @triplica
  soma_tripla(a, b) is -> int:
      return a + b

  shw(soma_tripla(2, 3))  // 15
  ```
- Decoradores podem ser empilhados.

### 6. **Par√¢metros Avan√ßados**
- **Vari√°dicos:** `*args`
- **Keyword-only:** `*, x=1, y=2`
- **Padr√£o:** `x=10`
- **Tipo:** `x:int`
- Exemplo:
  ```syra
  info(nome, *detalhes, idade=99, cidade="N/A") is:
      return "Nome: " + nome + " | Idade: " + str(idade) + " | Cidade: " + cidade + " | Detalhes: " + str(detalhes)"
  ```

### 7. **Comando `shw`**
- Mostra o valor de uma express√£o, vari√°vel ou chamada de fun√ß√£o Syra.
- Exemplo:
  ```syra
  shw($idade)
  shw(soma(2, 3))
  ```

### 8. **Comando `syra.vd`**
- Abre a webcam (usando OpenCV).
- Exemplo:
  ```syra
  syra.vd(0)
  ```

### 9. **Bloco `match`**
- Estrutura de decis√£o semelhante ao `match`/`switch` de outras linguagens.
- Sintaxe:
  ```syra
  resultado = match $idade:
      case 0          => "Rec√©m-nascido"
      case 1..12      => "Crian√ßa"
      case 13..17     => "Adolescente"
      case 18..59     => "Adulto"
      case 60..200    => "Idoso"
      case _          => print("Idade inv√°lida")
  shw($resultado)
  ```

### 10. **Express√µes**
- O lado direito da atribui√ß√£o pode ser:
  - Um valor literal (`"texto"`, `123`)
  - Outra vari√°vel Syra (`$outra`)
  - Uma express√£o simples (ex: `$idade + 1` se suportado pelo Python `eval`)

### 11. **Coment√°rios**
- Linhas iniciadas com `//` s√£o ignoradas.
- Coment√°rios inline tamb√©m s√£o suportados:
  ```syra
  shw(soma(2, 3))  // Mostra 5
  ```

### 12. **Classes e Orienta√ß√£o a Objetos**

O Syra suporta **classes**, **heran√ßa**, **m√©todos de inst√¢ncia**, **m√©todos est√°ticos** e **super()**.

#### **Defini√ß√£o de Classes**

- Use `class NomeDaClasse:` para definir uma classe.
- Campos s√£o declarados diretamente no corpo da classe.
- M√©todos s√£o definidos com `nome_do_metodo():`.
- O m√©todo `init` √© o construtor da classe.

Exemplo:
```syra
class Pessoa:
    nome
    idade

    init(nome, idade):
        self.nome = nome
        self.idade = idade

    saudacao():
        shw("Ol√°, eu sou " + self.nome)
```

#### **Heran√ßa**

- Use `class NomeDaClasse : ClasseBase:` para herdar de outra classe.
- Use `super(...)` para chamar o construtor da classe base.

Exemplo:
```syra
class Funcionario : Pessoa:
    cargo

    init(nome, idade, cargo):
        super(nome, idade)
        self.cargo = cargo

    saudacao():
        shw("Ol√°, sou " + self.nome + " e sou " + self.cargo)
```

#### **Instancia√ß√£o e M√©todos**

- Instancie objetos com `Classe(args)` e atribua a uma vari√°vel.
- Chame m√©todos com `$obj.metodo()`.

Exemplo:
```syra
$p = Pessoa("Jo√£o", 30)
$p.saudacao()

$f = Funcionario("Ana", 25, "Dev")
$f.saudacao()
```

#### **M√©todos Est√°ticos**

- Use `static` antes do nome do m√©todo para definir m√©todos est√°ticos.
- Chame m√©todos est√°ticos diretamente pela classe.

Exemplo:
```syra
class Matematica:
    static quadrado(x):
        return x * x

shw(Matematica.quadrado(5))  # Sa√≠da: 25
```

---

### **Sistema de Importa√ß√£o de M√≥dulos**

O Syra suporta um sistema de importa√ß√£o robusto, permitindo reutilizar c√≥digo entre arquivos `.syra` e importar funcionalidades de m√≥dulos Python.

#### **Sintaxe de Importa√ß√£o**

- **Importar m√≥dulo inteiro**  
  ```syra
  expor math_utils
  ```
  Importa todo o m√≥dulo e seus s√≠mbolos. Voc√™ acessa s√≠mbolos via `math_utils.nome`.

- **Importar s√≠mbolos espec√≠ficos**  
  ```syra
  from math_utils expor quadrado, pi
  ```
  Importa apenas os s√≠mbolos desejados diretamente no escopo.

- **Importar com alias**  
  ```syra
  from math_utils expor cubo as elevar3
  ```
  Importa o s√≠mbolo com um novo nome.

- **Importar classes e us√°-las**  
  ```syra
  from math_utils expor Angulo
  $a = Angulo(180)
  shw($a.radianos())
  ```

#### **Tipos de Importa√ß√£o**

- **M√≥dulos Syra** (`.syra`):  
  Arquivos Syra com fun√ß√µes, classes e vari√°veis reutiliz√°veis.  
  Mant√™m escopo isolado para evitar conflitos de nomes.

- **M√≥dulos Python**:  
  Acesso a m√≥dulos padr√£o do Python (ex: `math`, `random`).  
  Lista controlada de m√≥dulos permitidos por seguran√ßa.

#### **Exemplo de M√≥dulo Syra**

Arquivo `math_utils.syra`:
```syra
class Matematica:
    static quadrado(x):
        return x * x

    static cubo(x):
        return x * x * x

pi = 3.14159

class Angulo:
    init(graus):
        self.graus = graus
    radianos():
        return self.graus * pi / 180
```

Usando o m√≥dulo em outro arquivo:
```syra
expor math_utils
shw(math_utils.pi)
shw(math_utils.Matematica.quadrado(4))

from math_utils expor quadrado, pi
shw(quadrado(5))
shw(pi)

from math_utils expor cubo as elevar3
shw(elevar3(2))

from math_utils expor Angulo
$a = Angulo(180)
shw($a.radianos())
```

#### **Benef√≠cios**

- **Organiza√ß√£o**: Divide c√≥digo em m√≥dulos tem√°ticos.
- **Reutiliza√ß√£o**: Compartilha c√≥digo entre arquivos.
- **Namespaces**: Evita conflitos de nomes.
- **Extensibilidade**: Integra√ß√£o com bibliotecas Python existentes.

---

### 13. **Comandos Especiais de Arquivo e Sistema (`&`)**

A linguagem Syra agora suporta comandos especiais para manipula√ß√£o de arquivos e executar comandos do sistema operacional, todos identificados pelo prefixo `&`.  
Esses comandos s√£o diferenciados de fun√ß√µes e classes, tornando o c√≥digo mais claro e seguro.

#### **Comandos dispon√≠veis:**

- `&Syope(nome, extens√£o)` ‚Äî Cria ou abre um arquivo para escrita/leitura.
- `&Sywr(arquivo, conte√∫do)` ‚Äî Escreve uma linha no arquivo aberto.
- `&Syread(arquivo)` ‚Äî L√™ e retorna o conte√∫do do arquivo (suporta `.txt`, `.csv`, `.json`, `.xlsx`).
- `&Sycls(arquivo)` ‚Äî Fecha o arquivo aberto.
- `&SyraOS(comando)` ‚Äî Executa um comando no terminal e retorna a sa√≠da.

#### **Exemplo de uso:**
```syra
$arquivo = &Syope("exemplo", ".txt")
&Sywr($arquivo, "Ol√°, mundo!")
&Sywr($arquivo, "Segunda linha")
$conteudo = &Syread($arquivo)
shw($conteudo)
&Sycls($arquivo)
```

#### **Leitura de arquivos CSV, JSON e Excel**
```syra
$dados = &Syread("planilha.xlsx")
shw($dados)
```

#### **Execu√ß√£o de comandos do sistema**
```syra
$resultado = &SyraOS("dir")  // Windows
shw($resultado)
```

---

### 14. **Diferencia√ß√£o clara de comandos (`&`)**

- **Comandos especiais** sempre come√ßam com `&` (ex: `&Sywr`, `&Syread`), evitando conflito com nomes de fun√ß√µes ou classes.
- O interpretador reconhece e executa esses comandos de forma otimizada, inclusive em atribui√ß√µes (`$var = &Syread(...)`).

---

### 15. **Case-insensitive para comandos especiais**

- Os comandos com `&` funcionam tanto em mai√∫sculas quanto min√∫sculas (`&Sywr` ou `&sywr`).

---

### 16. **Sistema de tipos e convers√£o**

- Vari√°veis Syra reconhecem tipos b√°sicos (`int`, `float`, `str`, `bool`, `list`, etc.).
- Convers√£o f√°cil:  
  ```syra
  $idade = "25"
  $idade.int
  $valor = "3.14159"
  $valor.float(2)  // 3.14
  ```

---

### 17. **Resumo das novidades**

- **Comandos de arquivo e sistema** com `&` (Syope, Sywr, Syread, Sycls, SyraOS).
- **Leitura de arquivos**: `.txt`, `.csv`, `.json`, `.xlsx`.
- **Execu√ß√£o de comandos do SO** via SyraOS.
- **Convers√£o de tipos** com `.int`, `.float(n)`, `.string`, etc.
- **Case-insensitive** para comandos especiais.
- **Diferencia√ß√£o clara** entre comandos, fun√ß√µes e classes.

---

### **Resumo**

- **Fun√ß√µes Syra**: Suporte completo a fun√ß√µes, lambdas, decoradores e par√¢metros avan√ßados.
- **Classes**: Organize c√≥digo e reutilize l√≥gica.
- **Heran√ßa**: Extens√£o de funcionalidades.
- **M√©todos est√°ticos**: L√≥gica independente de inst√¢ncias.
- **super()**: Acesse l√≥gica da classe base.
- **Blocos `match`**: Decis√£o poderosa e expressiva.
- **Importa√ß√£o de m√≥dulos**: Modularize e reutilize c√≥digo facilmente.
- **Coment√°rios inline**: Suporte a `//` em qualquer parte da linha.
- **Comandos especiais**: Manipula√ß√£o de arquivos e sistema com `&`.

---

## üõ†Ô∏è Regras Gerais

- **Todas as vari√°veis** devem come√ßar com `$`.
- **Comandos** s√£o registrados no dicion√°rio `commands` e podem ser expandidos facilmente.
- **Blocos `match`** s√£o detectados automaticamente no arquivo `.syra` e no REPL.
- **Modo REPL** mant√©m o estado das vari√°veis enquanto a sess√£o estiver aberta.
- **Atribui√ß√£o de listas**:  
  ```syra
  $lista = []
  ```
- **Strings** podem ser com aspas simples ou duplas.

---

## üß© Como adicionar novos comandos

No arquivo `func.py`, crie uma fun√ß√£o `cmd_nome` e registre no dicion√°rio `commands`:
```python
def cmd_hello(args):
    print("Ol√°,", args)
commands["hello"] = cmd_hello
```
No Syra:
```
hello Syra!
```

---

## üìÑ Exemplo Completo

```syra
$idade = 25
resultado = match $idade:
    case 0          => "Rec√©m-nascido"
    case 1..12      => "Crian√ßa"
    case 13..17     => "Adolescente"
    case 18..59     => "Adulto"
    case 60..200    => "Idoso"
    case _          => print("Idade inv√°lida")
shw($resultado)
```

---

## üìù Observa√ß√µes

- O interpretador n√£o depende de indenta√ß√£o, mas sim do in√≠cio das linhas (`case ...`) para blocos.
- O REPL aceita blocos: digite a linha com `:` e depois as linhas do bloco, finalizando com uma linha em branco.
- O sistema √© facilmente expans√≠vel para novos comandos e estruturas.

---

**Contribua ou sugira melhorias!**